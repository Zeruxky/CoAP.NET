<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      internalLogFile=".\fulllog.txt" internalLogLevel="Trace">

  <!-- 
  See http://nlog-project.org/wiki/Configuration_file 
  for information on customizing logging rules and outputs.
   -->

  <variable name="flatFileLayout" value="${longdate}|${level:uppercase=true}|${logger}|${message}|${exception:format=tostring}"/>
  <variable name="eventLogLayout" value="${message}|${logger}|${exception:format=ToString}"/>

  <targets async="false">

    <target name="logfile"
				xsi:type="File"
				fileName="${basedir}/logs/current/${logger}/log.txt"
				archiveFileName="${basedir}/logs/archive/${logger}/log_{#}.txt"
				archiveAboveSize="1024000"
				archiveNumbering="DateAndSequence"
				layout="${flatFileLayout}"
				archiveEvery="Day"
				maxArchiveFiles="10"
				openFileCacheSize="5"
				keepFileOpen="true"
    />

    <target name="logfilefull"
			 xsi:type="File"
			 fileName="${basedir}/logs/current/fulllog.txt"
			 archiveNumbering="DateAndSequence"
			 archiveFileName="${basedir}/logs/archive/fulllog_{###}.txt"
			 archiveAboveSize="10240000"
			 archiveEvery="Day"
			 maxArchiveFiles="100"
			 layout="${flatFileLayout}"
			 openFileCacheSize="5"
			 keepFileOpen="true"
    />

    <target name="console"
            xsi:type="ColoredConsole"
            detectConsoleAvailable="true"
    />

    <target xsi:type="Chainsaw"
            name="chainsaw"
            newLine="true"
            onOverflow="Split"
            encoding="utf-8"
            address="udp://127.0.0.1:7071"
            keepConnection="true"
            includeSourceInfo="true"
            includeCallSite="true"
            includeNdc="false"
            includeNdlc="false"
            includeNLogData="false"
            includeMdlc="false"
            includeMdc="false"
    />

    <target name="seq" xsi:type="BufferingWrapper" bufferSize="1000"
            flushTimeout="2000" slidingTimeout="false">
      <target xsi:type="Seq" serverUrl="http://localhost:5341" apiKey="" >
        <property name="MachineName" value="${machinename}" />
        <property name="Service" value="${processname:fullName=false}" />
        <property name="ThreadId" value="${threadid}" as="number" />
        <property name="Source" value="${logger}" />
        <property name="Scope" value="${ndlc}" />
      </target>
    </target>

  </targets>

  <rules>
    <logger name="*" minlevel="Trace" writeTo="chainsaw,logfilefull,console,seq"></logger>
  </rules>

  <include ignoreErrors="true" file="${basedir}/NLog.project.config"/>

</nlog>